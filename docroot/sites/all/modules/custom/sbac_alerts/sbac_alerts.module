<?php
/**
 * @file
 * Code for the SBAC Alerts feature.
 */

include_once 'sbac_alerts.features.inc';

/**
 * Implements hook_theme().
 *
 * @param $existing
 * @param $type
 * @param $theme
 * @param $path
 * @return array
 */
function sbac_alerts_theme($existing, $type, $theme, $path) {
  $themes = array();

  $themes['views_view__sbac_alerts__important_notifications'] = array(
    'template' => 'templates/views-view--sbac-alerts--important-notifications',
    'arguments' => array('view' => NULL),
    'original hook' => 'views_view',
    'preprocess functions' => array(
      'template_preprocess',
      'template_preprocess_views_view',
      'sbac_help_preprocess_views_view__sbac_alerts__important_notifications'
    ),
  );

  return $themes;
}

/**
 * Preprocessor for the help_topics__block view.
 *
 * @param $vars
 */
function sbac_help_preprocess_views_view__sbac_alerts__important_notifications(&$vars){
  $alert_settings = array(
    'token' => drupal_get_token(),
  );
  drupal_add_js(array('sbac_alert_settings' => $alert_settings), 'setting');
}
